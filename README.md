# Докеризация приложения

В этой проектной работе нужно было докеризировать сервис вишлистов, который состоял из трех частей: бэкенд-сервиса на Node.js, БД (PostrgreSQL) и фронтенда на React (раздаётся nginx), а затем развернуть его в Яндекс Облаке.

## Докеризацмя бэкенда
Описан сценарий сборки образа бэкенда в Dockerfile.

Собранный образ удовлетворяет следующим критериям:
  ○ Рабочая директория (WORKDIR) — /app.
  ○ В качестве базового образа используется node:16-alpine.
  ○ Сборка осуществляется в два этапа (multi-stage build). 
  
На первом осуществляется сборка проекта, а на втором — запуск билда в окружении с минимальным набором npm-зависимостей. 

Для установки зависимостей на каждом из этапов используется npm. Установка зависимостей осуществляется при помощи команды npm i или npm ci. 

Обратите внимание: в финальном образе не должно быть исходников (директории src), а также dev-зависимостей и необходимых конфигов. 

○ Зависимости проекта корректно кэшируются. Проверьте себя: соберите образ, затем измените номер порта и запустите сборку повторно. Если Dockerfile описан корректно, этап установки зависимостей будет пропущен с пометкой CACHED. 
		
Запуск проекта осуществляется при помощи pm2.

## Докеризация фронтенда
В репозитории проекта есть директория frontend, создана поддиректория nginx/conf.d с файлом default.conf со следующим содержимым:
```nginx
server {
	listen 80;
	server_name localhost;
	location / {
		root /usr/share/nginx/html;
		index index.html index.htm;
		# Исправляем роутинг на фронтенде
		try_files $uri $uri/ /index.html;
	}
} 
```
В Dockerfile описана сборка фронтенда в два этапа: для первого потребуется базовый образ node:16-alpine, а для второго — nginx:1.23.1-alpine. На втором этапе скопирован билд фронтенда в образ с nginx, а также конфиг. Конфиг будет по пути /etc/nginx/conf.d внутри контейнера.
## Файл docker-compose
Собран файл docker-compose.yml.

В нём описаны три сервиса: backend, frontend, database. Для каждого из них задано имя контейнера, директория сборки (контекст). 

Порт базы данных доступен только во внутренней сети и только контейнеру с бэкендом.
